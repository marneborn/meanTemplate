git co develop
git pull gh develop

git co <mybranch>
git merge --no-ff develop
git co develop
git merge --squash <mybranch>
git add .
git ci 
git branch -D <mybranch>

;; make sure everything works in dev
grunt jshint-all
grunt jasmine_nodejs:server-unit
grunt build:css
grunt dev-web-tests
webdriver-manager start
node server.js --development --port=8080
grunt prd-e2e-tests

;; make sure everything works in prd
grunt build:dist
grunt prd-web-tests
webdriver-manager start
node server.js --production --host=local --port=8080
grunt prd-e2e-tests

;; create release branch
git co -b release-<version>

npm version patch --no-git-tag-version
git add package.json
git ci -m "Updated version"

git co master
;; Only keep the one previous version.
grunt clean:pre-build build:dist
git merge --no-ff release-<version>
git mergetool -- .gitignore
;; Run all tests

git add .
git tag -a -m "nm" v<version>
git ci -m "Released version: <version>"

git co develop
git merge --no-ff release-<version>

git push --follow-tags gh develop master

git branch -D release-<version>

## On production server
git fetch gh
git pull gh master
./scripts/restart.ps1
